#
# Switch
#
# on/off device
#
# substitutions:
#   once = 1 - once triggered can't be used again
#

component: Entity
entityList: Usable
size: [32, 32]
children:
  - component: UsableComponent
    children:
        - component: ScriptComponent
          name: OnUse
          script: >
              var c = findFirstChild(entity, 'State')
              var activeC = getActiveComponent(c)
              var n = getName(activeC)
              //var t = ${target}
              if (n == 'Closed') {
                //if ('${once}' == '1') {
                //  print('Switch has already been triggered')
                //  return
                //}
                print('Switch set to open')
                setActiveComponent(c, 'Open')
              } else {
                print('Switch set to closed')
                setActiveComponent(c, 'Closed')
              }
  - component: SwitchComponent
    name: State
    activeComponent: Closed
    components:
      - name: Closed
        component: SpriteComponent
        image: switch.png
        size: [32, 32]
        srcPosition: [0, 0]
        srcSize: [160, 160]
      - name: Open
        component: SpriteComponent
        image: switch.png
        size: [32, 32]
        srcPosition: [160, 160]
        srcSize: [160, 160]